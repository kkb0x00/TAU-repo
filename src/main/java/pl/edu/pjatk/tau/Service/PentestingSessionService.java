package pl.edu.pjatk.tau.Service;

import pl.edu.pjatk.tau.Domain.PentestingSession;
import pl.edu.pjatk.tau.Repository.PentestRepository;

import java.util.*;

public class PentestingSessionService {
    private PentestRepository repository;
    private IOTimesService ioTimesService;

    public PentestingSessionService(
        PentestRepository repository,
        IOTimesService ioTimesService
    ) {
        this.repository = repository;
        this.ioTimesService = ioTimesService;
    }

    public PentestingSession get(int id) {
        PentestingSession session = repository.get(id);

        if(session != null) {
            ioTimesService.setlastReadTime(session);
        }

        return session;
    }

    public List<PentestingSession> getAll() {
        List<PentestingSession> sessions = repository.getAll();

        for (PentestingSession session: sessions) {
            ioTimesService.setlastReadTime(session);
        }

        return sessions;
    }

    public void add(PentestingSession pentestingSession) {
        ioTimesService.setInsertTime(pentestingSession);
        repository.add(pentestingSession);
    }

    public void update(PentestingSession pentestingSession) {
        PentestingSession session = repository.get(pentestingSession.getId());

        if(session != null) {
            ioTimesService.setlastUpdateTime(pentestingSession);
            repository.update(pentestingSession);
        }
    }

    public void delete(int id) {
        PentestingSession session = repository.get(id);

        if(session != null) {
            repository.delete(id);
        }
    }
}
